<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Server Assistant - Minecraft Server Monitoring and issue reporting/handling tool">
    <meta name="author" content="storm345">

    <title>Server Assistant</title>

	<link rel="icon" 
      type="image/png" 
      href="img/brand/logo_icon.png">
	
    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/landing-page.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body data-spy="scroll" data-target=".navbar" data-offset="50">

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-fixed-top topnav" role="navigation">
        <div class="container topnav">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand topnav" href="index.html" style="padding-top:0px;"><img src="img/brand/logo_reduced.png" style="height:50px;" alt="Server Assistant" /></a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="index.html#about">About</a>
                    </li>
                    <li>
                        <a href="index.html#download">Download</a>
                    </li>
                    <li>
                        <a href="index.html#documentation">Documentation</a>
                    </li>
					<li>
                        <a href="index.html#api">API</a>
                    </li>
					<li>
                        <a href="https://github.com/storm345/ServerAssistantIssues/issues" target="_blank" >Report Issue</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>
	
	
    <div class="content-section-a" id="pagecontent" style="padding-bottom:5px;">

        <div class="container">
            <a href="index.html#documentation" class="lead"><span class="fa fa-toggle-left"></span> Back to homepage</a>

        </div>
        <!-- /.container -->

    </div>
	
	<a  name="content"></a>
	<div class="content-section-a" id="pagecontent" style="padding-top:5px;">

        <div class="container">
            <h1>Configuring issue responses:</h1>
			<div>
				<p>An 'issue response' is an action that occurs when an issue is detected and a report is generated. It can do anything from dim your lighting in your house, to sending a notification to your server's Slack telling you the server has crashed and the cause.</p>
				
				<h3>Default responses:</h3>
				<ol>
					<li><a href="#archive"><b>The Archive (Issue Log)</b> - Logs issues and thread dumps</a></li>
					<li><a href="#IFTTT"><b>If This Then That (Notifications)</b> - Can send emails, SMS, dim your lights, etc...</a></li>
					<li><a href="#slack"><b>Slack (Notifications)</b> - Can notify you and your team of issues and their cause</a></li>
					<li><a href="#customWebhook"><b>Custom Web Hook</b> - Allows you to submit (Via POST request) an issue report to your own website to handle as you wish.</a></li>
					<li><a href="api.html#example" target="_blank"><b>Create your own</b> - Create your own response using the API</a></li>
				</ol>
				
				<div id="archive">
					<h2>The Archive (Issue Log):</h2>
					<img src="img/sample/small/sampleReport.PNG" />
					<p>'The Archive' is a log of issues and also manually invoked thread dumps. By default it will write the logs to the plugin folder, although this can be changed and the issue logs can even be inserted into a database. <b>Config file: 'archiveConfig.yml'</b></p>
					<table class="table table-striped table-hover">
						<tr>
							<th>Config Key</th>
							<th>Default Value</th>
							<th>Description</th>
						</tr>
						<tr>
							<td>filesystem: path</td>
							<td>&lt;Server Directory&gt;/plugins/ServerAssistant/Report Archive</td>
							<td>This is where, if filesystem is used, logs of issues are saved to. This can be any directory on the machine.</td>
						</tr>
						<tr>
							<td>filesystem: useFileSystem</td>
							<td>true</td>
							<td>If this is true, issues are logged to the file system in the path specified.</td>
						</tr>
						<tr>
							<td>saveJSONCopyOfReport</td>
							<td>false</td>
							<td>If this is true then a JSON representation of the reported event is also saved. This allows other applications to extract specific data from the reports. (Eg. for analysing statistics)</td>
						</td>
						<tr>
							<td>database: useDatabase</td>
							<td>false</td>
							<td>If this is true, issues are logged to the SQL database specified.</td>
						</tr>
						<tr>
							<td>database: name</td>
							<td>serverAssistantDB</td>
							<td>This is the name of your database</td>
						</tr>
						<tr>
							<td>database: host</td>
							<td>localhost</td>
							<td>This is the host of your database, eg. localhost:3306</td>
						</tr>
						<tr>
							<td>database: user</td>
							<td>user</td>
							<td>This is the username of the user to login to your database via</td>
						</tr>
						<tr>
							<td>database: pass</td>
							<td>pass</td>
							<td>This is the password of the user to login to your database via</td>
						</tr>
						<tr>
							<td>isEnabled</td>
							<td>true</td>
							<td>If this is true, then the archive will be enabled and logging reports.</td>
						</tr>
					</table>
				</div>
				<div id="IFTTT">
					<h2>If This Then That (Notifications):</h2>
					<p>'If This Then That' (<a href="http://ifttt.com/" target="_blank">ifttt.com</a>) is a website you can configure to perform actions in response to an event. For example, you can dim your lights when your server lags or (more helpfully) send an email. <b>Config file: 'ifThisThenThatConfig.yml'</b></p>
					<div id="setupIFTTT">
						<h4>Setting up 'If This Then That':</h4>
						<ol>
							<li><b>Login to</b> or <b>setup a free 'If This Then That' account</b>. You can do that by <a href="https://ifttt.com/join" target="_blank">visiting this page.</a></li>
							<li>Find out your <b>'maker channel key'</b>. Do that by going to <a href="https://ifttt.com/maker_webhooks" target="_blank">ifttt.com/maker_webhooks</a>, clicking <b>'Settings'</b>, visiting the web page at the <b>provided URL</b> and then taking a note of the <b>key</b> it says
							<br><img src="img/config/ifttt2/1.png" /><br><br><img src="img/config/ifttt2/2.png" /><br><br><img src="img/config/ifttt2/3.png" /></li>
							<li>Put your <b>maker channel key</b> into <a href="#makerChannelKeyConfigKey">the config</a></li>
							<li>Create a new applet at <a href="https://ifttt.com/create" target="_blank">https://ifttt.com/create</a></li>
							<li>Click on <b>'This'</b></li>
							<li>Select the service <b>'Webhooks'</b><br><img src="img/config/ifttt2/4.png" /></li>
							<li>Choose the <b>'Receive a web request'</b> trigger</li>
							<li>Make the <b>Event Name</b> the <b>EventID</b> as listed in <a href="#iftttListenedEventIDS">the config</a><br><img src="img/config/ifttt/4.png" /></li>
							<li>Click <b>'Create Trigger'</b></li>
							<li>Click on <b>'That'</b></li>
							<li>Select the <b>Action Channel</b> of choice. For example 'gmail'</li>
							<li>Select an <b>Action</b> of your choice. For example, 'Send an email'</li>
							<li>Complete the <b>Action Fields</b> as you desire. The following parameters may be used
								<ol>
									<li><b>{{EventName}}</b> - The EventID of the issue</li>
									<li><b>{{OccurredAt}}</b> - When the event occured</li>
									<li><b>{{Value1}}</b> - The name of the server</li>
									<li><b>{{Value2}}</b> - The type of issue. Eg. LAG, CRASH or CUSTOM</li>
									<li><b>{{Value3}}</b> - The detailed report of the issue. For example timings data, a thread dump, tps, etc...</li>
								</ol>
								<br><img src="img/config/ifttt/5.png" />
							</li>
							<li>Click <b>'Create Action'</b> and then <b>'Finish'</b><br><img src="img/config/ifttt2/5.png" /></li>
							<li>Make sure <b>to test</b> that your applet works. You can use <b>'/crashserver'</b> (Will only test freeze crashes) or <b>'/lagserver'</b> in game to do this</li>
						</ol>
					</div>
					<div id="configIFTTT">
						<h4>Configuring 'If This Then That':</h4>
						<table class="table table-striped table-hover">
							<tr>
								<th>Config Key</th>
								<th>Default Value</th>
								<th>Description</th>
							</tr>
							<tr id="makerChannelKeyConfigKey">
								<td>makerChannelKey</td>
								<td>N/A</td>
								<td>This is the key to use with IFTTT for the maker channel. For information on how to setup IFTTT <a href="#setupIFTTT">click here</a></td>
							</tr>
							<tr>
								<td>useHTMLForNewLine</td>
								<td>true</td>
								<td>If this is true, lines in the issue report are separated via HTML (Eg. for emails), if false the newline character will be used.</td>
							</tr>
							<tr id="iftttListenedEventIDS">
								<td>listenedEventIDs</td>
								<td>CRASH_HARD, CRASH_TIMEOUT, LAG_COMBINED, ERROR, CUSTOM</td>
								<td>Lets you specify which event IDs this will respond to. If you want to respond to a custom event, add it's EventID here</td>
							</tr>
							<tr>
								<td>isEnabled</td>
								<td>false</td>
								<td>If this is true, then the IFTTT will be enabled.</td>
							</tr>
						</table>
					</div>
				</div>
				<div id="slack">
					<h2>Slack (Notifications):</h2>
					<img src="img/sample/small/sampleNotificationSlack.PNG" />
					<p><a href="https://slack.com/" target="_blank">Slack</a> is a messaging app for teams and is used by many big minecraft servers. Server Assistant allows you to send notifications to slack when issues occur, and their cause <b>Config file: 'slackConfig.yml'</b></p>
					<div id="setupSlack">
						<h4>Setting up a Slack hook:</h4>
						<ol>
							<li>Navigate to <a href="https://my.slack.com/apps/A0F7XDUAZ-incoming-webhooks" target="_blank"><b>https://&lt;Your Team Name&gt;.slack.com/apps/A0F7XDUAZ-incoming-webhooks</b></a></li>
							<li>Click <b>'Add Configuration'</b></li>
							<li><b>Configure the webhook</b>. You can ignore the 'Post To Channel' part as it is overriden in <a href="#configSlack">the config</a><br><img src="img/config/slack/1.png" /></li>
							<li>Click <b>'Add Incoming WebHooks integreation'</b></li>
							<li>Copy the <b>'Webhook URL'</b> it gives you into <a href="#configSlack">the config</a> (slackbotHookURL)<br><img src="img/config/slack/2.png" /></li>
							<li>Scroll down and click <b>'Save Settings'</b>. <a href="#configSlack">The config</a> will override much of what is configurable here.</li>
							<li><b>Test</b> that your Slack hook is working. You can use <b>'/crashserver'</b> (Will only test freeze crashes) or <b>'/lagserver'</b> in game to do this</li>
						</ol>
					</div>
					<div id="configSlack">
						<h4>Configuring a Slack Hook:</h4>
						<table class="table table-striped table-hover">
							<tr>
								<th>Config Key</th>
								<th>Default Value</th>
								<th>Description</th>
							</tr>
							<tr>
								<td>slackbotHookURL</td>
								<td>N/A</td>
								<td>The URL of the webhook to communicate with slack via. For information about setting up the slack hook, <a href="#setupSlack">see here</a></td>
							</tr>
							<tr>
								<td>slackbotChannel</td>
								<td>server-assistant</td>
								<td>The slack channel to post to</td>
							</tr>
							<tr>
								<td>botName</td>
								<td>Server Assistant</td>
								<td>The name of the bot as it will appear on slack</td>
							</tr>
							<tr>
								<td>botIconEmoji</td>
								<td>:warning:</td>
								<td>The icon of the bot on slack</td>
							</tr>
							<tr id="slackListenedEventIDS">
								<td>listenedEventIDs</td>
								<td>CRASH_HARD, CRASH_TIMEOUT, LAG_COMBINED, ERROR, CUSTOM</td>
								<td>Lets you specify which event IDs this will respond to. If you want to respond to a custom event, add it's EventID here</td>
							</tr>
							<tr>
								<td>isEnabled</td>
								<td>false</td>
								<td>If this is true, then the slack hook will be enabled</td>
							</tr>
						</table>
					</div>
				</div>
				<div id="customWebhook">
					<h2>Custom Webhook:</h2>
					<p>With the custom webhook action, you can submit an issue report (via a JSON formatted POST request) to your own website to handle as you wish. <b>Config file: 'customPostWebhookConfig.yml'</b></p>
					<div id="setupCustomWebhook">
						<h4>Setting up a Custom Webhook:</h4>
						<ol>
							<li><b>Create a page</b> on your website to submit the report to. Eg. '<a>https://mywebsite.com/issueReport</a>'. For this it may be a good idea to add a URL parameter like an 'API Key' so that not everybody in the world can POST an issue report.</li>
							<li><b>Set the URL</b> to POST the issue report to in <a href="#configCustomWebhook">the config</a></li>
							<li><b>Setup your website</b> to read the contents of the <b>POST</b> request as a <b>JSON message</b> and perform subsequent actions with. The POST request is generated by turning the report object directly into JSON. The request might look similar to this:
							<pre>{
  "serverName": "DEV",
  "eventID": "CRASH_TIMEOUT",
  "report": {
    "details": [
      "Thread dump:",
      "&lt;Line 1 of thread dump&gt;",
      "&lt;Line 2 of thread dump&gt;"
    ],
    "usedMemoryMB": 259,
    "maxMemoryMB": 954,
    "playerCount": 0,
    "time": 1472471015147,
    "serverUptime": 0,
    "nature": "CRASH_TIMEOUT",
    "eventID": "CRASH_TIMEOUT"
  }
}</pre> Since the conversion from Report->JSON is done automatically, it will also work with custom reports.
							</li>
						</ol>
					</div>
					<div id="configCustomWebhook">
						<h4>Configuring Custom Webhook:</h4>
						<table class="table table-striped table-hover">
							<tr>
								<th>Config Key</th>
								<th>Default Value</th>
								<th>Description</th>
							</tr>
							<tr>
								<td>hookURL</td>
								<td>N/A</td>
								<td>This is the URL to POST the report information to</td>
							</tr>
							<tr id="slackListenedEventIDS">
								<td>listenedEventIDs</td>
								<td>CRASH_HARD, CRASH_TIMEOUT, LAG_COMBINED, ERROR, CUSTOM</td>
								<td>Lets you specify which event IDs this will respond to. If you want to respond to a custom event, add it's EventID here</td>
							</tr>
							<tr>
								<td>isEnabled</td>
								<td>false</td>
								<td>If this is true, then the custom web hook will be enabled</td>
							</tr>
						</table>
					</div>
				</div>
			</div>

        </div>
        <!-- /.container -->

    </div>
    <!-- /.content-section-a -->
	
    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <p class="copyright text-muted small">Copyright &copy; storm345 2016. All Rights Reserved</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- jQuery -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>

</body>

</html>
